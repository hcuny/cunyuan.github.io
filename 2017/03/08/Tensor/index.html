<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="你没有学会游泳，就会被水淹没，就会不知所措。"><title>Basic Elements in TF | Chosen To Be</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/." class="title">Chosen To Be</a><span class="subtitle">Cunyuan's Tech Blog</span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/" class="sidebar-nav-item active">Home</a><a href="/archives" class="sidebar-nav-item">Archives</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>Basic Elements in TF</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">2017-03-08</div><div class="post-tags"><a class="post-tag-link" href="/tags/Deep-Learning/">Deep Learning</a></div></div></div><article><div class="container post"><p>Struggling with the second project of the Udacity course, image classification, it’s a key point to understand the process as a whole. Starting with:</p>
<h4 id="1-What-is-a-tensor"><a href="#1-What-is-a-tensor" class="headerlink" title="1. What is a tensor?"></a>1. What is a tensor?</h4><p>First of all, consider everything in a graph mode. <br></p>
<p>TensorFlow is a programming system in which you <strong>represent computations</strong> as graphs. <strong>Nodes</strong> in the graph are called ops ( operations). An op takes zero or more Tensors, performs some computation, and produces zero or more Tensors. A Tensor is a typed <strong>multi-dimensional array</strong>. For example, you can represent a mini-batch of images as a 4-D array of floating point numbers with dimensions [batch, height, width, channels]</p>
<p><img src="/img/tensor.jpg" alt="Alt text" title="different shapes of tensors"><br>Then we can claim: TensorFlow ~ Tensor + Flow <br><br>I.e. tensors (units of array-like data) flowing through nodes (different kinds of operations, inner product, sigmoid, softmax, relu, etc), all the nodes forms a neural network graph. <a href="https://github.com/hcuny/Deep-Learning-Projects-Udacity/blob/master/Projects/dlnd-your-first-neural-network.ipynb" target="_blank" rel="external">Demo</a> of a small NN.</p>
<p><img src="/img/nn.png" alt="Alt text"></p>
<h4 id="2-What-is-a-session"><a href="#2-What-is-a-session" class="headerlink" title="2. What is a session?"></a>2. What is a session?</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ sess = tf.Session()</div><div class="line">$ sess.run(x, feed_dict=&#123;~&#125;)</div></pre></td></tr></table></figure>
<p>It’s actually bringing the graph framework into implementation. <br><br>On the other hand, like the lazy computation of Spark RDDs, <strong>tf.placeholder()</strong> simply allocates a block of memory for future use in sess.run(), thus the computation graph/pipeline can be built ahead of any real data flow. Example of some commands that are part of the graph:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ input = tf.placeholder(tf.float32, (None, h, w, d))</div><div class="line">$ filter_weights = tf.Variable(tf.truncated_normal((H, W, in_d, out_d)))</div><div class="line">$ bias = tf.Variable(tf.zeros(conv_num_outputs))</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ conv_layer = tf.nn.conv2d(input, weight, strides=[1, 2, 2, 1], padding=<span class="string">'SAME'</span>)</div><div class="line">$ conv_layer = tf.nn.bias_add(conv_layer, bias)</div><div class="line">$ conv_layer = tf.nn.relu(conv_layer)</div><div class="line">$ conv_layer = tf.nn.max_pool( conv_layer, ksize=[1, 2, 2, 1], strides=[1, 2, 2, 1], padding=<span class="string">'SAME'</span>)</div><div class="line">$ session.run(optimizer, feed_dict=&#123;x: feature_batch, y: label_batch, keep_prob: keep_probability&#125;)</div></pre></td></tr></table></figure>
<h4 id="3-Why-CNN"><a href="#3-Why-CNN" class="headerlink" title="3. Why CNN?"></a>3. Why CNN?</h4><p><img src="/img/mdnet.png" alt="Alt text"></p>
<ul>
<li>Regular neural nets: nodes in a single layer are independent, will generate huge scale of weights.</li>
<li>Full connectivity is a waste of “adjacent” info, number of parameters lead to overfitting.</li>
<li>The depth of filter is just like different nodes in a single layer.(To capture different levels of info)</li>
<li>Number of filters ~ depth of filters</li>
<li>For the same filter (same depth), share all parameters. Example:<ul>
<li>Input shape 32x32x3 (H, W, D_Channel)</li>
<li>20 filters of shape 8x8x3, stride 2, padding 1.</li>
<li>Output shape -&gt; 14x14x20</li>
<li>No P sharing: (8x8x3+1)x(14x14x20)</li>
<li>With P sharing: (8x8x3+1)x20</li>
</ul>
</li>
</ul>
</div><!-- comment system--><div class="container"><hr></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="mailto:hcuny@live.unc.edu" target="_blank"><i class="fa fa-envelope-o"></i></a><a href="http://twitter.com/hcuny" target="_blank"><i class="fa fa-twitter"></i></a><a href="http://weibo.com/hcy19930424/profile?rightmod=1&amp;wvr=6&amp;mod=personnumber" target="_blank"><i class="fa fa-weibo"></i></a><a href="https://github.com/hcuny" target="_blank"><i class="fa fa-github"></i></a><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© 2017 <a href="/" rel="nofollow">Cunyuan(Anthony) Huang</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body></html>